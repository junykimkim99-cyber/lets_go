<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>2026 ìš´ì„¸ ìƒì„±ê¸°</title>
  <style>
    :root{
      --bg:#0b0f1a;
      --card:rgba(255,255,255,.08);
      --card2:rgba(255,255,255,.12);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.68);
      --line:rgba(255,255,255,.14);
      --accent:#7c5cff;
      --accent2:#2ee59d;
      --danger:#ff5c7a;
      --shadow:0 20px 60px rgba(0,0,0,.45);
      --radius:18px;
      --radius2:14px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Apple SD Gothic Neo","Noto Sans KR","Malgun Gothic", Arial, sans-serif;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 15% 10%, rgba(124,92,255,.20), transparent 60%),
        radial-gradient(900px 500px at 80% 20%, rgba(46,229,157,.16), transparent 55%),
        radial-gradient(1000px 700px at 45% 100%, rgba(255,92,122,.10), transparent 65%),
        var(--bg);
      min-height:100vh;
    }

    /* ---------- Light theme overrides (ë‹¤í¬ëŠ” ê¸°ë³¸ ìœ ì§€, ë¼ì´íŠ¸ì—ì„œë§Œ ë³€ìˆ˜ êµì²´) ---------- */
    body[data-theme="light"]{
      --bg:#f6f7fb;
      --card:rgba(0,0,0,.05);
      --card2:rgba(0,0,0,.07);
      --text:rgba(0,0,0,.88);
      --muted:rgba(0,0,0,.58);
      --line:rgba(0,0,0,.10);
      --shadow:0 18px 50px rgba(0,0,0,.12);
      background:
        radial-gradient(1200px 700px at 15% 10%, rgba(124,92,255,0.16), transparent 60%),
        radial-gradient(900px 500px at 80% 20%, rgba(46,229,157,0.12), transparent 55%),
        radial-gradient(1000px 700px at 45% 100%, rgba(255,92,122,0.10), transparent 65%),
        var(--bg);
    }
    body[data-theme="light"] input{
      background:rgba(255,255,255,.85);
      border:1px solid rgba(0,0,0,.12);
      color:var(--text);
    }
    body[data-theme="light"] input::placeholder{ color:rgba(0,0,0,.35); }
    body[data-theme="light"] .ghost{
      background:rgba(0,0,0,.04);
      border:1px solid rgba(0,0,0,.10);
      color:rgba(0,0,0,.78);
    }
    body[data-theme="light"] .pill,
    body[data-theme="light"] .quote{
      background:rgba(255,255,255,.70);
    }
    /* ------------------------------------------------------------------------------- */

    header{
      padding:34px 18px 10px;
      max-width:980px;
      margin:0 auto;
    }
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 12px;
      border:1px solid var(--line);
      border-radius:999px;
      background:rgba(255,255,255,.04);
      color:var(--muted);
      font-size:13px;
    }
    .dot{
      width:8px; height:8px; border-radius:50%;
      background:linear-gradient(135deg,var(--accent),var(--accent2));
      box-shadow:0 0 18px rgba(124,92,255,.55);
    }
    h1{
      margin:16px 0 8px;
      font-size:clamp(24px,4vw,40px);
      line-height:1.15;
      letter-spacing:-.02em;
    }
    .sub{
      margin:0 0 16px;
      color:var(--muted);
      font-size:15px;
      line-height:1.5;
      max-width:70ch;
    }
    main{
      max-width:980px;
      margin:0 auto;
      padding:14px 18px 60px;
      display:grid;
      grid-template-columns:1fr;
      gap:14px;
    }
    @media (min-width:920px){
      main{ grid-template-columns:.95fr 1.05fr; gap:16px; }
    }
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding:16px 16px 12px;
      border-bottom:1px solid var(--line);
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .title{
      font-size:15px;
      letter-spacing:-.01em;
      margin:0;
      color:rgba(255,255,255,.90);
    }
    body[data-theme="light"] .title{ color:rgba(0,0,0,.86); }
    .hint{
      font-size:12px;
      color:var(--muted);
      margin:0;
      white-space:nowrap;
    }
    .bd{ padding:16px; }
    .grid{
      display:grid;
      grid-template-columns:1fr;
      gap:12px;
    }
    @media (min-width:520px){
      .grid{ grid-template-columns:1fr 1fr; }
      .grid .span2{ grid-column:span 2; }
    }
    label{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin:0 0 7px;
    }
    input{
      width:100%;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(0,0,0,.18);
      color:var(--text);
      outline:none;
      font-size:14px;
    }
    input::placeholder{ color:rgba(255,255,255,.38); }
    input:focus{
      border-color:rgba(124,92,255,.75);
      box-shadow:0 0 0 4px rgba(124,92,255,.18);
    }
    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:14px;
    }
    button{
      border:0;
      border-radius:14px;
      padding:12px 14px;
      font-size:14px;
      color:rgba(255,255,255,.92);
      background:linear-gradient(135deg, rgba(124,92,255,.95), rgba(46,229,157,.70));
      cursor:pointer;
      box-shadow:0 16px 40px rgba(124,92,255,.22);
      transition:transform .06s ease, filter .2s ease;
    }
    button:hover{ filter:brightness(1.05); }
    button:active{ transform:translateY(1px); }
    .ghost{
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.18);
      box-shadow:none;
      color:rgba(255,255,255,.86);
    }
    .mini{
      font-size:12px;
      color:var(--muted);
      margin-left:auto;
    }
    .error{
      display:none;
      margin-top:10px;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid rgba(255,92,122,.35);
      background:rgba(255,92,122,.10);
      color:rgba(255,255,255,.90);
      font-size:13px;
      line-height:1.5;
    }
    body[data-theme="light"] .error{ color:rgba(0,0,0,.82); }

    .result{ display:none; }
    .hero{
      padding:18px 16px;
      background:linear-gradient(180deg, rgba(255,255,255,.06), transparent);
      border-bottom:1px solid var(--line);
    }
    .pillrow{
      display:flex; gap:8px; flex-wrap:wrap;
      margin-top:10px;
    }
    .pill{
      padding:7px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.16);
      background:rgba(0,0,0,.14);
      color:rgba(255,255,255,.78);
      font-size:12px;
    }
    body[data-theme="light"] .pill{
      border:1px solid rgba(0,0,0,.10);
      color:rgba(0,0,0,.72);
    }

    .scoregrid{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
      margin-top:14px;
    }
    @media (min-width:520px){
      .scoregrid{ grid-template-columns:1fr 1fr 1fr 1fr; }
    }
    .score{
      padding:12px;
      border-radius:14px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.14);
    }
    body[data-theme="light"] .score{
      background:rgba(255,255,255,.72);
      border:1px solid rgba(0,0,0,.08);
    }
    .score .k{ font-size:12px; color:var(--muted); margin:0 0 6px; }
    .score .v{ font-size:20px; margin:0; letter-spacing:-.02em; }
    .score .bar{
      height:7px;
      border-radius:999px;
      background:rgba(255,255,255,.10);
      overflow:hidden;
      margin-top:10px;
    }
    body[data-theme="light"] .score .bar{ background:rgba(0,0,0,.08); }
    .score .bar > div{
      height:100%;
      width:0%;
      border-radius:999px;
      background:linear-gradient(90deg, rgba(124,92,255,.95), rgba(46,229,157,.75));
      transition:width .6s ease;
    }

    .section{
      margin-top:14px;
      padding:14px;
      border-radius:var(--radius2);
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.14);
    }
    body[data-theme="light"] .section{
      background:rgba(255,255,255,.72);
      border:1px solid rgba(0,0,0,.08);
    }
    .section h3{
      margin:0 0 8px;
      font-size:14px;
      letter-spacing:-.01em;
    }
    .section p{
      margin:0;
      color:rgba(255,255,255,.78);
      font-size:13px;
      line-height:1.65;
    }
    body[data-theme="light"] .section p{ color:rgba(0,0,0,.72); }

    .quote{
      margin-top:12px;
      padding:12px 12px;
      border-radius:14px;
      border:1px dashed rgba(255,255,255,.18);
      background:rgba(0,0,0,.14);
      font-family:var(--mono);
      color:rgba(255,255,255,.78);
      font-size:12px;
      line-height:1.55;
      white-space:pre-wrap;
    }
    body[data-theme="light"] .quote{
      border:1px dashed rgba(0,0,0,.16);
      color:rgba(0,0,0,.70);
    }

    footer{
      max-width:980px;
      margin:0 auto;
      padding:0 18px 34px;
      color:rgba(255,255,255,.52);
      font-size:12px;
      line-height:1.6;
    }
    body[data-theme="light"] footer{ color:rgba(0,0,0,.52); }
  </style>
</head>

<body>
  <header>
    <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;">
      <div class="badge"><span class="dot"></span> 2026 Fortune â€¢ single file</div>

      <button
        type="button"
        class="ghost"
        id="themeToggle"
        aria-label="í…Œë§ˆ ì „í™˜"
        style="border-radius:999px;padding:10px 12px;display:inline-flex;align-items:center;gap:8px;">
        <span id="themeIcon" aria-hidden="true">ğŸŒ™</span>
        <span id="themeText" style="font-size:13px;">ë‹¤í¬</span>
      </button>
    </div>

    <h1>2026 ìš´ì„¸ ìƒì„±ê¸°</h1>
    <p class="sub">
      ì´ë¦„, ìƒë…„ì›”ì¼, í‚¤, ëª¸ë¬´ê²Œë¥¼ ì…ë ¥í•˜ë©´ 2026ë…„ ìš´ì„¸ë¥¼ ìƒì„±í•´ë“œë ¤ìš”.
      ì…ë ¥ê°’ì€ ì €ì¥/ì „ì†¡í•˜ì§€ ì•Šê³  ì´ í˜ì´ì§€ ì•ˆì—ì„œë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤.
    </p>
  </header>

  <main>
    <section class="card" aria-label="ì…ë ¥">
      <div class="hd">
        <p class="title">ì •ë³´ ì…ë ¥</p>
        <p class="hint">ëª¨ë“  ê°’ì€ í•„ìˆ˜</p>
      </div>

      <div class="bd">
        <form id="fortuneForm" autocomplete="on" novalidate>
          <div class="grid">
            <div class="span2">
              <label for="name">ì´ë¦„</label>
              <input id="name" name="name" type="text" maxlength="30" placeholder="ì˜ˆ: ê¹€ì¤€íœ˜" required />
            </div>

            <div>
              <label for="birth">ìƒë…„ì›”ì¼</label>
              <input id="birth" name="birth" type="date" required />
            </div>

            <div>
              <label for="height">í‚¤ (cm)</label>
              <input id="height" name="height" type="number" min="50" max="250" inputmode="numeric" placeholder="ì˜ˆ: 175" required />
            </div>

            <div>
              <label for="weight">ëª¸ë¬´ê²Œ (kg)</label>
              <input id="weight" name="weight" type="number" min="10" max="250" step="0.1" inputmode="decimal" placeholder="ì˜ˆ: 68.5" required />
            </div>

            <div class="span2">
              <div class="row">
                <button type="submit">ìš´ì„¸ ë³´ê¸°</button>
                <button type="button" class="ghost" id="randomBtn">ì˜ˆì‹œ ë°ì´í„°</button>
                <span class="mini">ğŸ”’ ì €ì¥/ì „ì†¡ ì—†ìŒ</span>
              </div>
              <div class="error" id="errorBox"></div>
            </div>
          </div>
        </form>
      </div>
    </section>

    <section class="card result" id="resultCard" aria-label="ê²°ê³¼">
      <div class="hero">
        <p class="title" id="headline">2026 ìš´ì„¸</p>
        <p class="sub" id="summary" style="margin:6px 0 0;"></p>
        <div class="pillrow" id="pillRow"></div>
        <div class="scoregrid" id="scoreGrid"></div>
      </div>

      <div class="bd">
        <div class="section">
          <h3>ğŸ’¼ ì¼/í•™ì—…</h3>
          <p id="workText"></p>
        </div>

        <div class="section">
          <h3>ğŸ’° ê¸ˆì „</h3>
          <p id="moneyText"></p>
        </div>

        <div class="section">
          <h3>â¤ï¸ ì—°ì• /ê´€ê³„</h3>
          <p id="loveText"></p>
        </div>

        <div class="section">
          <h3>ğŸ§  ê±´ê°•/ì»¨ë””ì…˜</h3>
          <p id="healthText"></p>
        </div>

        <div class="section">
          <h3>ğŸ¯ 2026 í•œ ì¤„ ì¡°ì–¸</h3>
          <p id="adviceText"></p>
          <div class="quote" id="debugQuote"></div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    * ì¬ë¯¸ìš© ìš´ì„¸ ë°ëª¨ì…ë‹ˆë‹¤. ì˜ë£Œ/ì¬ì •/ë²•ë¥  ì¡°ì–¸ì´ ì•„ë‹™ë‹ˆë‹¤.<br/>
    * í™•ì¥ ì•„ì´ë””ì–´: ì›”ë³„ ìš´ì„¸, ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ì €ì¥, ê³µìœ  ë§í¬(ì¿¼ë¦¬ìŠ¤íŠ¸ë§), í…Œë§ˆ ì „í™˜, ê²°ê³¼ ì´ë¯¸ì§€ë¡œ ì €ì¥ ë“±.
  </footer>

  <script>
    // -----------------------------
    // Deterministic RNG
    // -----------------------------
    const normalize = (v) => String(v ?? "").trim();

    // FNV-1a 32-bit hash
    function fnv1a32(str){
      let h = 0x811c9dc5;
      for(let i=0;i<str.length;i++){
        h ^= str.charCodeAt(i);
        h = Math.imul(h, 0x01000193);
      }
      return h >>> 0;
    }

    // Mulberry32 PRNG
    function mulberry32(seed){
      let a = seed >>> 0;
      return function(){
        a |= 0; a = (a + 0x6D2B79F5) | 0;
        let t = Math.imul(a ^ (a >>> 15), 1 | a);
        t = (t + Math.imul(t ^ (t >>> 7), 61 | t)) ^ t;
        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
      }
    }

    function clamp(n,min,max){ return Math.max(min, Math.min(max,n)); }
    function round1(n){ return Math.round(n*10)/10; }
    function pick(rng, arr){ return arr[Math.floor(rng()*arr.length)]; }

    // -----------------------------
    // Date / zodiac helpers
    // -----------------------------
    function toDateParts(dateStr){
      const m = /^(\d{4})-(\d{2})-(\d{2})$/.exec(dateStr);
      if(!m) return null;
      return { y:+m[1], mo:+m[2], d:+m[3] };
    }

    // Western zodiac (ê°„ë‹¨)
    function zodiacByMonthDay(mo, d){
      if((mo==1 && d<20) || (mo==12 && d>=22)) return "ì—¼ì†Œìë¦¬";
      if((mo==1 && d>=20) || (mo==2 && d<19)) return "ë¬¼ë³‘ìë¦¬";
      if((mo==2 && d>=19) || (mo==3 && d<21)) return "ë¬¼ê³ ê¸°ìë¦¬";
      if((mo==3 && d>=21) || (mo==4 && d<20)) return "ì–‘ìë¦¬";
      if((mo==4 && d>=20) || (mo==5 && d<21)) return "í™©ì†Œìë¦¬";
      if((mo==5 && d>=21) || (mo==6 && d<22)) return "ìŒë‘¥ì´ìë¦¬";
      if((mo==6 && d>=22) || (mo==7 && d<23)) return "ê²Œìë¦¬";
      if((mo==7 && d>=23) || (mo==8 && d<23)) return "ì‚¬ììë¦¬";
      if((mo==8 && d>=23) || (mo==9 && d<24)) return "ì²˜ë…€ìë¦¬";
      if((mo==9 && d>=24) || (mo==10 && d<24)) return "ì²œì¹­ìë¦¬";
      if((mo==10 && d>=24) || (mo==11 && d<23)) return "ì „ê°ˆìë¦¬";
      if((mo==11 && d>=23) || (mo==12 && d<22)) return "ì‚¬ìˆ˜ìë¦¬";
      return "ì—¼ì†Œìë¦¬";
    }

    function chineseZodiac(year){
      // 2016 = ì›ìˆ­ì´ë¡œ ë§ì¶˜ ë°°ì—´
      const animals = ["ì›ìˆ­ì´","ë‹­","ê°œ","ë¼ì§€","ì¥","ì†Œ","í˜¸ë‘ì´","í† ë¼","ìš©","ë±€","ë§","ì–‘"];
      const idx = ((year - 2016) % 12 + 12) % 12;
      return animals[idx];
    }

    function lifePathNumber(y, mo, d){
      const s = String(y) + String(mo).padStart(2,"0") + String(d).padStart(2,"0");
      let sum = 0;
      for(const ch of s) sum += ch.charCodeAt(0) - 48;
      while(sum > 9){
        let t=0;
        for(const ch of String(sum)) t += ch.charCodeAt(0) - 48;
        sum = t;
      }
      return sum === 0 ? 9 : sum;
    }

    function bmi(heightCm, weightKg){
      const h = heightCm / 100;
      return weightKg / (h*h);
    }

    // -----------------------------
    // Text banks
    // -----------------------------
    const toneTitles = [
      { key:"ìƒìŠ¹", desc:"ì˜¬í•´ëŠ” â€˜ê°ì„±â€™ê³¼ â€˜í™•ì¥â€™ì˜ ê¸°ìš´ì´ ê°•í•©ë‹ˆë‹¤." },
      { key:"ì•ˆì •", desc:"ì˜¬í•´ëŠ” â€˜ì •ë¦¬â€™ì™€ â€˜ê²¬ê³ í•¨â€™ì´ ìš´ì„ ë§Œë“­ë‹ˆë‹¤." },
      { key:"ë³€í™”", desc:"ì˜¬í•´ëŠ” â€˜ì „í™˜â€™ê³¼ â€˜ì‹¤í—˜â€™ì´ í•µì‹¬ì…ë‹ˆë‹¤." },
      { key:"ì§‘ì¤‘", desc:"ì˜¬í•´ëŠ” â€˜ì„ íƒâ€™ê³¼ â€˜ëª°ì…â€™ì´ ì„±ê³¼ë¡œ ì—°ê²°ë©ë‹ˆë‹¤." },
      { key:"íšŒë³µ", desc:"ì˜¬í•´ëŠ” â€˜ë¦¬ì…‹â€™ê³¼ â€˜íšŒë³µâ€™ì´ ë‹¤ìŒ ë„ì•½ì„ ì¤€ë¹„í•©ë‹ˆë‹¤." }
    ];

    const workBank = [
      "ìƒë°˜ê¸°ì—ëŠ” ê³„íšì„ â€˜ì‘ê²Œ ìª¼ê°œì„œâ€™ ì‹¤í–‰í• ìˆ˜ë¡ ê²°ê³¼ê°€ ë¹¨ë¦¬ ë¶™ìŠµë‹ˆë‹¤. í° íŒë³´ë‹¤ ì‘ì€ ìŠ¹ë¦¬ë¥¼ ë°˜ë³µí•´ë³´ì„¸ìš”.",
      "ì˜¬í•´ëŠ” í˜‘ì—… ìš´ì´ ì¢‹ìŠµë‹ˆë‹¤. í˜¼ì ëŒê³  ê°€ê¸°ë³´ë‹¤ ì—­í• ì„ ë¶„ë¦¬í•˜ë©´ ì†ë„ê°€ í™• ì˜¬ë¼ê°‘ë‹ˆë‹¤.",
      "ìƒˆ ë„êµ¬/ê¸°ìˆ ì„ ìµíˆëŠ” íë¦„ì´ ê°•í•©ë‹ˆë‹¤. ìµìˆ™í•œ ë°©ì‹ 80%, ì‹¤í—˜ 20%ê°€ ì•ˆì „í•œ ì¡°í•©ì´ì—ìš”.",
      "ì´ˆë°˜ì— ë°©í–¥ ì¬ì¡°ì • ì´ë²¤íŠ¸ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°”ê¾¸ëŠ” ê±¸ ì‹¤íŒ¨ê°€ ì•„ë‹ˆë¼ ì—…ë°ì´íŠ¸ë¡œ ë³´ì„¸ìš”.",
      "ê²°ì •í•´ì•¼ í•  ìˆœê°„ì—ëŠ” â€˜ê°€ì¥ ë‹¨ìˆœí•œ ë‹¤ìŒ í–‰ë™â€™ì´ ë‹µì¼ ë•Œê°€ ë§ìŠµë‹ˆë‹¤. í•œ ë‹¨ê³„ë§Œ ì¤„ì—¬ë³´ì„¸ìš”."
    ];

    const moneyBank = [
      "ê¸ˆì „ìš´ì€ â€˜ìƒˆëŠ” êµ¬ë© ë§‰ê¸°â€™ì—ì„œ í¬ê²Œ ì˜¬ë¼ê°‘ë‹ˆë‹¤. êµ¬ë…/ê³ ì •ë¹„ë¥¼ í•œ ë²ˆë§Œ ì •ë¦¬í•´ë„ ì²´ê°ì´ í½ë‹ˆë‹¤.",
      "í˜„ê¸ˆíë¦„ì„ ì•ˆì •ì‹œí‚¤ë©´ ìš´ì´ ì¢‹ì•„ì§‘ë‹ˆë‹¤. ë³€ë™ì§€ì¶œ ìƒí•œì„ ì„ ì •í•´ë‘ë©´ ë§ˆìŒì´ í¸í•´ì ¸ìš”.",
      "ê¸°íšŒë¹„ìš©ì„ ê³„ì‚°í•˜ëŠ” ìŠµê´€ì´ ëˆì„ ì§€ì¼œì¤ë‹ˆë‹¤. â€˜ì‹œê°„ 1ì‹œê°„ì˜ ê°’â€™ì„ ê¸°ì¤€ìœ¼ë¡œ ê²°ì •ì„ í•´ë³´ì„¸ìš”.",
      "ë‹¨ê¸° ìœ í–‰ë³´ë‹¤ ëˆ„ì í˜• ì„ íƒì´ ìœ ë¦¬í•©ë‹ˆë‹¤. ì‘ê²Œë¼ë„ ê¾¸ì¤€íˆ ìŒ“ëŠ” êµ¬ì¡°ê°€ ì˜¬í•´ì˜ í‚¤ì›Œë“œì˜ˆìš”.",
      "ë¹„êµ ì†Œë¹„ë¥¼ ì¤„ì¼ìˆ˜ë¡ ìš´ì´ ì¢‹ì•„ì§‘ë‹ˆë‹¤. â€˜ë‚˜ì—ê²Œ í•„ìš”í•œ ê¸°ì¤€â€™ì„ ë¬¸ì¥ìœ¼ë¡œ ì •í•´ë‘ë©´ í”ë“¤ë¦¼ì´ ì¤„ì–´ìš”."
    ];

    const loveBank = [
      "ê´€ê³„ìš´ì€ â€˜ë§ì˜ ì˜¨ë„â€™ê°€ ì¢Œìš°í•©ë‹ˆë‹¤. ì¤‘ìš”í•œ ì–˜ê¸°ëŠ” í”¼ê³¤í•  ë•Œ ë§ê³ , ì»¨ë””ì…˜ ì¢‹ì€ ì‹œê°„ì— ì¡ì•„ë³´ì„¸ìš”.",
      "ì˜¬í•´ëŠ” ìì—°ìŠ¤ëŸ½ê²Œ ê°€ê¹Œì›Œì§€ëŠ” ì¸ì—°ì´ ìˆìŠµë‹ˆë‹¤. ì–µì§€ë¡œ ë‹¹ê¸°ê¸°ë³´ë‹¤ â€˜ë¹ˆë„â€™ë¥¼ ì¡°ê¸ˆë§Œ ëŠ˜ë¦¬ë©´ ì¶©ë¶„í•´ìš”.",
      "ê²½ê³„ ì„¤ì •(ì„  ê¸‹ê¸°)ì´ ì˜¤íˆë ¤ ê´€ê³„ë¥¼ í¸í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤. ê¸°ëŒ€ì¹˜ë¥¼ ë§ì¶”ë©´ ê°ˆë“±ì´ í¬ê²Œ ì¤„ì–´ìš”.",
      "ì¹œí•œ ì‚¬ì´ì¼ìˆ˜ë¡ ì‘ì€ ì•½ì†ì„ ì§€í‚¤ëŠ” ê²Œ ìš´ì„ ì˜¬ë¦½ë‹ˆë‹¤. â€˜ì‚¬ì†Œí•œ ì‹ ë¢°â€™ê°€ ì˜¬í•´ì˜ í° ë³µì…ë‹ˆë‹¤.",
      "ë‚´ê°€ ì›í•˜ëŠ” ê²ƒ/ì‹«ì€ ê²ƒì„ ë˜ë ·í•˜ê²Œ ë§í• ìˆ˜ë¡ ì¢‹ì€ ë°©í–¥ìœ¼ë¡œ í˜ëŸ¬ê°‘ë‹ˆë‹¤."
    ];

    const healthBank = [
      "ì»¨ë””ì…˜ì€ â€˜ìˆ˜ë©´ + ë£¨í‹´â€™ì´ ê²°ì •í•©ë‹ˆë‹¤. ëŠ¦ê²Œ ìëŠ” ë‚ ì´ ìˆì–´ë„ ê¸°ìƒ ì‹œê°„ì„ ê³ ì •í•˜ë©´ íšŒë³µì´ ë¹¨ë¼ìš”.",
      "ì˜¬í•´ëŠ” ê³¼ë¡œê°€ ëˆ„ì ë˜ê¸° ì‰¬ìš°ë‹ˆ â€˜ì¤‘ê°„ ì ê²€â€™ì´ í•„ìš”í•©ë‹ˆë‹¤. ì£¼ 1íšŒëŠ” ì˜ë„ì ìœ¼ë¡œ ì†ë„ë¥¼ ë‚®ì¶°ë³´ì„¸ìš”.",
      "ìš´ë™ì€ ê°•ë„ë³´ë‹¤ ë¹ˆë„ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤. 20ë¶„ì´ë¼ë„ ìì£¼ í•˜ëŠ” ìª½ì´ ì²´ê°ì´ ì»¤ìš”.",
      "ì¹´í˜ì¸ íƒ€ì´ë° ì¡°ì •ì´ ë„ì›€ì´ ë©ë‹ˆë‹¤. ì˜¤í›„ ëŠ¦ê²Œë§Œ í”¼í•´ë„ ìˆ˜ë©´ ì§ˆì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆì–´ìš”.",
      "ì§‘ì¤‘ë ¥ì´ ë–¨ì–´ì§ˆ ë•ŒëŠ” ì˜ì§€ë³´ë‹¤ í™˜ê²½ ë¬¸ì œì¼ ë•Œê°€ ë§ìŠµë‹ˆë‹¤. ì‘ì—… ê³µê°„ì„ ë‹¨ìˆœí™”í•´ë³´ì„¸ìš”."
    ];

    const adviceBank = [
      "ì˜¬í•´ì˜ ìŠ¹ë¶€ìˆ˜ëŠ” â€˜ì‘ê²Œ ì‹œì‘í•´ì„œ í¬ê²Œ í‚¤ìš°ê¸°â€™ì…ë‹ˆë‹¤.",
      "ì†ë„ê°€ ì•„ë‹ˆë¼ â€˜ì§€ì†ê°€ëŠ¥í•œ ë¦¬ë“¬â€™ì´ ê²°ê³¼ë¥¼ ë§Œë“­ë‹ˆë‹¤.",
      "ì„ íƒì„ ì¤„ì´ë©´ ì—ë„ˆì§€ê°€ ë‚¨ê³ , ì—ë„ˆì§€ê°€ ë‚¨ìœ¼ë©´ ìš´ì´ ì¢‹ì•„ì§‘ë‹ˆë‹¤.",
      "ê´€ê³„ëŠ” ìì‚°ì…ë‹ˆë‹¤. ì—°ê²°ì„ ê´€ë¦¬í•˜ë©´ ê¸°íšŒê°€ ë”°ë¼ì˜µë‹ˆë‹¤.",
      "ì™„ë²½ë³´ë‹¤ â€˜ì™„ë£Œâ€™ê°€ ë” ê°•ë ¥í•©ë‹ˆë‹¤. ëë‚¸ ê²ƒë§Œì´ ë‚˜ë¥¼ ë°”ê¿‰ë‹ˆë‹¤."
    ];

    const monthFocus = [
      "1~2ì›”: ì •ë¦¬/ì •ëˆ", "3~4ì›”: ì‹œë™/ì‹¤í—˜", "5~6ì›”: í™•ì¥/í˜‘ì—…",
      "7~8ì›”: ì§‘ì¤‘/ëª°ì…", "9~10ì›”: ìˆ˜í™•/ì •ì‚°", "11~12ì›”: ë¦¬ì…‹/ì¬ì„¤ê³„"
    ];

    // -----------------------------
    // DOM
    // -----------------------------
    const form = document.getElementById("fortuneForm");
    const errorBox = document.getElementById("errorBox");
    const resultCard = document.getElementById("resultCard");

    const headline = document.getElementById("headline");
    const summary = document.getElementById("summary");
    const pillRow = document.getElementById("pillRow");
    const scoreGrid = document.getElementById("scoreGrid");

    const workText = document.getElementById("workText");
    const moneyText = document.getElementById("moneyText");
    const loveText = document.getElementById("loveText");
    const healthText = document.getElementById("healthText");
    const adviceText = document.getElementById("adviceText");
    const debugQuote = document.getElementById("debugQuote");

    const randomBtn = document.getElementById("randomBtn");

    function showError(msg){
      errorBox.style.display = "block";
      errorBox.textContent = msg;
      resultCard.style.display = "none";
    }
    function clearError(){
      errorBox.style.display = "none";
      errorBox.textContent = "";
    }

    function makeScoreTile(label, value){
      const el = document.createElement("div");
      el.className = "score";
      el.innerHTML = `
        <p class="k">${label}</p>
        <p class="v">${value}<span style="font-size:12px;color:var(--muted)"> / 100</span></p>
        <div class="bar"><div></div></div>
      `;
      requestAnimationFrame(() => {
        el.querySelector(".bar > div").style.width = value + "%";
      });
      return el;
    }

    // -----------------------------
    // Fortune generation
    // -----------------------------
    function computeFortune({name, birth, height, weight}){
      const nm = normalize(name);
      const parts = toDateParts(birth);
      if(!nm) return { error:"ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”." };
      if(!parts) return { error:"ìƒë…„ì›”ì¼ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”." };

      const h = Number(height);
      const w = Number(weight);
      if(!Number.isFinite(h) || h < 50 || h > 250) return { error:"í‚¤(cm)ë¥¼ 50~250 ì‚¬ì´ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”." };
      if(!Number.isFinite(w) || w < 10 || w > 250) return { error:"ëª¸ë¬´ê²Œ(kg)ë¥¼ 10~250 ì‚¬ì´ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”." };

      const zodiac = zodiacByMonthDay(parts.mo, parts.d);
      const cz = chineseZodiac(parts.y);
      const lp = lifePathNumber(parts.y, parts.mo, parts.d);

      const bmiVal = bmi(h, w);
      const bmiRounded = round1(bmiVal);

      // seed: ì…ë ¥ + "2026" ê³ ì •
      const seedStr = `${nm}|${birth}|${h}|${w}|2026`;
      const seed = fnv1a32(seedStr);
      const rng = mulberry32(seed);

      // flavor bias (ì¬ë¯¸ìš©)
      const bmiBias =
        (bmiVal >= 18.5 && bmiVal < 25) ? 6 :
        (bmiVal >= 25 && bmiVal < 30) ? -2 :
        (bmiVal < 18.5) ? -1 : -4;
      const lpBias = (lp - 5) * 2; // -8 ~ +8

      const tone = pick(rng, toneTitles);
      const focus = pick(rng, monthFocus);

      // scores (0~100)
      const workScore   = Math.round(clamp(55 + (rng()-0.5)*60 + lpBias, 0, 100));
      const moneyScore  = Math.round(clamp(50 + (rng()-0.5)*60 + (lpBias/2), 0, 100));
      const loveScore   = Math.round(clamp(52 + (rng()-0.5)*60 + (rng()-0.5)*10, 0, 100));
      const healthScore = Math.round(clamp(58 + (rng()-0.5)*60 + bmiBias, 0, 100));

      // texts
      const work = pick(rng, workBank);
      const money = pick(rng, moneyBank);
      const love = pick(rng, loveBank);
      const healthBase = pick(rng, healthBank);

      // BMI ê¸°ë°˜ â€œë¶€ë“œëŸ¬ìš´â€ ë¬¸êµ¬ë§Œ ì¶”ê°€ (ì˜í•™ ì¡°ì–¸ X)
      let health = healthBase;
      if(bmiVal < 18.5){
        health += " ë„ˆë¬´ ë¹¡ì„¸ê²Œ ë‹¬ë¦¬ê¸°ë³´ë‹¤ëŠ”, ì‹ì‚¬/íœ´ì‹ì˜ ë¦¬ë“¬ë¶€í„° ì¡ëŠ” í¸ì´ ì¢‹ìŠµë‹ˆë‹¤.";
      } else if(bmiVal >= 25 && bmiVal < 30){
        health += " ë£¨í‹´ì„ â€˜ê°€ë³ê²Œ, ê¾¸ì¤€íˆâ€™ ê°€ì ¸ê°€ë©´ ì²´ê° ì„±ê³¼ê°€ ì˜ ë‚˜ì˜µë‹ˆë‹¤.";
      } else if(bmiVal >= 30){
        health += " ë¶€ë‹´ í° ëª©í‘œë³´ë‹¤, ì‘ê²Œ ì‹œì‘í•´ì„œ ìœ ì§€í•˜ëŠ” ìª½ì´ í›¨ì”¬ ìœ ë¦¬í•©ë‹ˆë‹¤.";
      } else {
        health += " ì§€ê¸ˆì˜ ë°¸ëŸ°ìŠ¤ë¥¼ ìœ ì§€í•˜ëŠ” ê²Œ ì˜¬í•´ ìµœê³ ì˜ ì „ëµì´ì—ìš”.";
      }

      const advice = pick(rng, adviceBank);

      const summaryText =
        `${nm}ë‹˜ì˜ 2026ë…„ í‚¤ì›Œë“œëŠ” â€˜${tone.key}â€™ì…ë‹ˆë‹¤. ${tone.desc} ` +
        `íŠ¹íˆ ${focus} êµ¬ê°„ì—ì„œ íë¦„ì´ ì¢‹ì•„ì§ˆ ê°€ëŠ¥ì„±ì´ í½ë‹ˆë‹¤.`;

      return {
        seedStr, seed,
        nm, birth, h, w,
        zodiac, cz, lp,
        bmiRounded,
        tone, focus,
        scores: { workScore, moneyScore, loveScore, healthScore },
        texts: { work, money, love, health, advice, summaryText }
      };
    }

    function renderFortune(data){
      headline.textContent = `2026 ìš´ì„¸ Â· ${data.nm}ë‹˜`;
      summary.textContent = data.texts.summaryText;

      pillRow.innerHTML = "";
      const pills = [
        `ë³„ìë¦¬: ${data.zodiac}`,
        `ë : ${data.cz}`,
        `ë¼ì´í”„íŒ¨ìŠ¤: ${data.lp}`,
        `BMI: ${data.bmiRounded}`
      ];
      for(const p of pills){
        const el = document.createElement("div");
        el.className = "pill";
        el.textContent = p;
        pillRow.appendChild(el);
      }

      scoreGrid.innerHTML = "";
      scoreGrid.appendChild(makeScoreTile("ì¼/í•™ì—…", data.scores.workScore));
      scoreGrid.appendChild(makeScoreTile("ê¸ˆì „", data.scores.moneyScore));
      scoreGrid.appendChild(makeScoreTile("ì—°ì• /ê´€ê³„", data.scores.loveScore));
      scoreGrid.appendChild(makeScoreTile("ê±´ê°•/ì»¨ë””ì…˜", data.scores.healthScore));

      workText.textContent = data.texts.work;
      moneyText.textContent = data.texts.money;
      loveText.textContent = data.texts.love;
      healthText.textContent = data.texts.health;
      adviceText.textContent = data.texts.advice;

      debugQuote.textContent =
`[ìƒì„± ê·¼ê±° ìš”ì•½]
- seed: ${data.seed} (ì…ë ¥ê°’ ê¸°ë°˜ ê²°ì •ë¡ )
- ì…ë ¥: ${data.seedStr}
- ë³„ìë¦¬: ${data.zodiac} / ë : ${data.cz} / ë¼ì´í”„íŒ¨ìŠ¤: ${data.lp} / BMI: ${data.bmiRounded}
- ì˜¬í•´ í‚¤ì›Œë“œ: ${data.tone.key} / í¬ì»¤ìŠ¤: ${data.focus}`;

      resultCard.style.display = "block";
      resultCard.scrollIntoView({ behavior:"smooth", block:"start" });
    }

    // -----------------------------
    // Form events
    // -----------------------------
    form.addEventListener("submit", (e) => {
      e.preventDefault();
      clearError();

      const payload = {
        name: document.getElementById("name").value,
        birth: document.getElementById("birth").value,
        height: document.getElementById("height").value,
        weight: document.getElementById("weight").value
      };

      const res = computeFortune(payload);
      if(res.error){
        showError(res.error);
        return;
      }
      renderFortune(res);
    });

    randomBtn.addEventListener("click", () => {
      const samples = [
        { name:"ê¹€ì¤€íœ˜", birth:"1999-11-02", height:175, weight:68.5 },
        { name:"í™ê¸¸ë™", birth:"2001-03-14", height:172, weight:70.2 },
        { name:"ì´ì„œì—°", birth:"1998-07-09", height:162, weight:54.0 }
      ];
      const s = samples[Math.floor(Math.random()*samples.length)];
      document.getElementById("name").value = s.name;
      document.getElementById("birth").value = s.birth;
      document.getElementById("height").value = s.height;
      document.getElementById("weight").value = s.weight;

      clearError();
      const res = computeFortune(s);
      if(!res.error) renderFortune(res);
    });

    // -----------------------------
    // Theme (Dark/Light) toggle
    // -----------------------------
    const THEME_KEY = "fortune_theme";
    const themeBtn = document.getElementById("themeToggle");
    const themeIcon = document.getElementById("themeIcon");
    const themeText = document.getElementById("themeText");

    function applyTheme(theme){
      // theme: "dark" | "light"
      if(theme === "light"){
        document.body.setAttribute("data-theme", "light");
        themeIcon.textContent = "â˜€ï¸";
        themeText.textContent = "ë¼ì´íŠ¸";
      } else {
        document.body.removeAttribute("data-theme"); // default = dark
        themeIcon.textContent = "ğŸŒ™";
        themeText.textContent = "ë‹¤í¬";
      }
    }

    function getInitialTheme(){
      const saved = localStorage.getItem(THEME_KEY);
      if(saved === "light" || saved === "dark") return saved;

      const prefersLight = window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: light)").matches;

      return prefersLight ? "light" : "dark";
    }

    let currentTheme = getInitialTheme();
    applyTheme(currentTheme);

    themeBtn.addEventListener("click", () => {
      currentTheme = (currentTheme === "light") ? "dark" : "light";
      localStorage.setItem(THEME_KEY, currentTheme);
      applyTheme(currentTheme);
    });
  </script>
</body>
</html>